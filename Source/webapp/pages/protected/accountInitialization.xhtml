<ui:composition template="/WEB-INF/templates/base.xhtml" 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:p="http://primefaces.org/ui">
  <ui:define name="title"><h:outputText value="#{msg.account_Initialization}" /></ui:define>
  <ui:define name="content">
  <ui:include src="/WEB-INF/includes/mainLogo.xhtml">
    <ui:param name="extraHeaderDetail" value="#{msg.firstTimeUser}" />
  </ui:include>
  <div class="container">
    <h:form id="account-settings" styleClass="nl-form">
      <ol class="steps">
        <ui:remove>Step 1: Setting Unit System</ui:remove>
        <li class="#{accountSetupController.getStepCss('STEP1')}">
          <span>
            <h:outputText value="#{msg.unitSystemStep1}" />
          </span>
          <ui:include src="/WEB-INF/tags/formFieldDropdown.xhtml">
            <ui:param name="binding"  value="#{accountSetupController.unitSystem}" />
            <ui:param name="selected" value="#{accountSetupController.selectedUnitSystem}" />
            <ui:param name="items"    value="#{accountSetupController.unitSystems}" />
            <ui:param name="fieldId"  value="unit-system" />
          </ui:include>
          <span>
            <h:outputText value="#{msg.unitSystemStep2}" />
          </span>
        </li>
        
        <ui:remove>Step 2: Setting gender, height, and starting weight.</ui:remove>
        <li class="#{accountSetupController.getStepCss('STEP2')}">
          <span>
            <h:outputText value="#{msg.genderStep}" />
          </span>
          <ui:include src="/WEB-INF/tags/formFieldDropdown.xhtml">
            <ui:param name="binding"  value="#{accountSetupController.accountModel.gender}" />
            <ui:param name="selected" value="#{accountSetupController.selectedGender}" />
            <ui:param name="items"    value="#{accountSetupController.genders}" />
            <ui:param name="fieldId"  value="gender" />
          </ui:include>
          
          <span>
            <h:outputText value="#{msg.heightStep}" />
          </span>
          <ui:remove>Imperial Height block..</ui:remove>
          <h:panelGroup id="height-imperial" rendered="#{accountSetupController.imperialUnitSystem}">
          <ui:include src="/WEB-INF/tags/formFieldDropdown.xhtml">
            <ui:param name="binding"  value="#{accountSetupController.currentSettings.heightInFeet}" />
            <ui:param name="selected" value="#{accountSetupController.currentSettings.heightInFeet}" />
            <ui:param name="items"    value="#{accountSetupController.footItems}" />
            <ui:param name="fieldId"  value="height-large-value" />
            <ui:param name="ulSize"   value="small" />
          </ui:include>
          <span class="ft"> </span>
          
          <ui:include src="/WEB-INF/tags/formFieldDropdown.xhtml">
            <ui:param name="binding"  value="#{accountSetupController.currentSettings.heightInInches}" />
            <ui:param name="selected" value="#{accountSetupController.currentSettings.heightInInches}" />
            <ui:param name="items"    value="#{accountSetupController.inchItems}" />
            <ui:param name="fieldId"  value="height-small-value" />
            <ui:param name="ulSize"   value="small" />
          </ui:include>
          <span class="in"> </span>
          </h:panelGroup>
          <ui:remove>Metric Height block</ui:remove>
          <h:panelGroup rendered="#{not accountSetupController.imperialUnitSystem}">
            <h:inputText id="height-metric" styleClass="height" value="#{accountSetupController.currentSettings.heightInCentimeters}" maxlength="4" />
            <p:watermark for="height-metric" value="#{msg.emptyNumber}" />
            <span class="cm"></span>
          </h:panelGroup>
          
          <span><h:outputText value="#{msg.weightStep}" /></span>
          <h:inputText id="current-weight" styleClass="weight" value="#{accountSetupController.currentWeight.weightString}" maxlength="6" />
          <p:watermark for="current-weight" value="#{msg.emptyNumber}" />
          <span id="weight-unit" class="#{accountSetupController.imperialUnitSystem ? 'lbs' : 'kg'}"></span>
        </li>
        
        <ui:remove>Step 3: Activity Multiplier</ui:remove>
        <li class="#{accountSetupController.getStepCss('STEP3')}">
          <span><h:outputText value="#{msg.activityMultiplierStep}" /></span><br />
          <ui:include src="/WEB-INF/tags/formFieldDropdown.xhtml">
            <ui:param name="binding"  value="#{accountSetupController.currentSettings.activityMultiplier}" />
            <ui:param name="selected" value="#{accountSetupController.selectedActivityMultiplier}" />
            <ui:param name="items"    value="#{accountSetupController.activityMultipliers}" />
            <ui:param name="fieldId"  value="activity-multiplier" />
          </ui:include>
        </li>
        
        <ui:remove>Step 4: Setting the Recalculation day and the TDEE Formula</ui:remove>
        <li class="#{accountSetupController.getStepCss('STEP4')}">
          <span><h:outputText value="#{msg.calculationStep1}" /></span>
          <span id="every-weekday" class="#{accountSetupController.recalculatedDaily ? 'hidden' : ''}"><h:outputText value="#{msg.every}" /></span>
          <ui:include src="/WEB-INF/tags/formFieldDropdown.xhtml">
            <ui:param name="binding"  value="#{accountSetupController.currentSettings.recalculationDay}" />
            <ui:param name="selected" value="#{accountSetupController.selectedRecalculationDay}" />
            <ui:param name="items"    value="#{accountSetupController.weekdays}" />
            <ui:param name="fieldId"  value="recalculation-day" />
          </ui:include>
          
          <span>
            <h:outputText value="#{msg.calculationStep2}" />
          </span>
          <ui:include src="/WEB-INF/tags/formFieldDropdown.xhtml">
            <ui:param name="binding"  value="#{accountSetupController.currentSettings.tdeeFormula}" />
            <ui:param name="selected" value="#{accountSetupController.selectedFormula}" />
            <ui:param name="items"    value="#{accountSetupController.formulas}" />
            <ui:param name="fieldId"  value="tdee-formula" />
          </ui:include>
          <span><h:outputText value="#{msg.calculationStep3}" /></span>
        </li>
        
        <ui:remove>Step 5: Setting the birthday or Age</ui:remove>
        <li class="#{accountSetupController.getStepCss('STEP5')}">
          <h:selectBooleanCheckbox id="using-age" value="#{accountController.currentSettings.usingAge}">
            <f:ajax event="click" execute="@this" render="birthday age birthday-age-prefix birthday-age-suffux" />
          </h:selectBooleanCheckbox>
          <span><h:outputText value="#{msg.birthdayOrAge}" /></span><br />
          <span><h:outputText id="birthday-age-prefix" value="#{accountSetupController.birthdayAgePrefix}" /></span>
          <h:inputText id="birthday" value="#{accountSetupController.accountModel.birthday}" maxlength="10"
                       styleClass="date #{accountSetupController.currentSettings.usingAge ? 'hidden' : ''}">
            <f:converter converterId="#{accountSetupController.imperialUnitSystem ? 'dateConverter' : 'europeanDateConverter'}" />
          </h:inputText>
          <p:watermark id="date-format" for="birthday" value="#{accountSetupController.currentDateFormat}" />
          <h:inputText id="age" value="#{accountSetupController.currentSettings.age}" maxlength="3"
                       styleClass="age #{accountSetupController.currentSettings.usingAge ? '' : 'hidden'}" />
          <p:watermark for="age" value="#{msg.defaultAge}" />
          <span><h:outputText id="birthday-age-suffux" value="#{accountSetupController.birthdayAgeSuffux}" /></span>
        </li>
      </ol>
      
      <div id="form-field-overlay" class="form-field-overlay"></div>
      <div class="controls">
        <ui:remove>I can't figure out how to get @form or something else nice to work... So have to give every visible field in the execute :/.</ui:remove>
        <h:commandButton id="previous" styleClass="previous" style="#{accountSetupController.firstStep ? 'visibility: hidden' : ''}"
                         value="#{msg.previous}">
          <f:ajax event="click" render="@form" execute="#{accountSetupController.executables}"
                  listener="#{accountSetupController.previousStep}" onevent="addEventListeners" />
        </h:commandButton>
        <h:commandButton id="next" styleClass="next" rendered="#{not accountSetupController.lastStep}"
                         value="#{msg.next}">
          <f:ajax event="click" render="@form" execute="#{accountSetupController.executables}"
                  listener="#{accountSetupController.nextStep}" onevent="addEventListeners" />
        </h:commandButton>
        <h:commandButton value="#{msg.submit}" action="#{accountSetupController.createOrUpdateAccountSettings()}"
                         rendered="#{accountSetupController.lastStep}" />
      </div>
    </h:form>
  </div>
  <h:outputScript library="js/account" name="accountInitialization.js" />
  <h:outputScript library="js" name="nlForm.js" />
  </ui:define>
</ui:composition>